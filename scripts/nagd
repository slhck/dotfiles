#!/usr/bin/env ruby
# Send periodic reminder notifications (daemon)
require 'json'

MINUTES = 20

def notify(*args)
  pid = spawn('notify', *args)
  return Process.wait2(pid)[1].exited?
end

notify('nag', "you'll get a reminder every #{MINUTES} minutes")

trap('SIGINT') { exit }

while true
  pid = fork do
    sleep MINUTES * 60
    notify('nag', "it's been #{MINUTES} minutes")
  end
  Process.wait(pid)
end
